
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>SMEFT19.comparepulls &#8212; SMEFT19 1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for SMEFT19.comparepulls</h1><div class="highlight"><pre>
<span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">================</span>
<span class="sd">comparepulls</span>
<span class="sd">================</span>

<span class="sd">This module contains several functions used to compare between different NP scenarios and the Standard Model.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">.ellipse</span> <span class="k">import</span> <span class="n">load</span><span class="p">,</span> <span class="n">parametrize</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">SMEFTglob</span>
<span class="kn">from</span> <span class="nn">.SMEFTglob</span> <span class="k">import</span> <span class="n">loadobslist</span>
<span class="kn">from</span> <span class="nn">wilson</span> <span class="k">import</span> <span class="n">Wilson</span>
<span class="kn">import</span> <span class="nn">flavio</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">from</span> <span class="nn">flavio.statistics.functions</span> <span class="k">import</span> <span class="n">delta_chi2</span><span class="p">,</span> <span class="n">pull</span>

<span class="k">def</span> <span class="nf">sign</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
	<span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">):</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="k">return</span> <span class="mi">1</span>

<span class="k">def</span> <span class="nf">tex</span><span class="p">(</span><span class="n">obs</span><span class="p">):</span>
	<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
		<span class="n">text</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs</span><span class="p">]</span><span class="o">.</span><span class="n">tex</span>
	<span class="k">else</span><span class="p">:</span>
		<span class="n">text</span> <span class="o">=</span> <span class="n">flavio</span><span class="o">.</span><span class="n">Observable</span><span class="p">[</span><span class="n">obs</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">tex</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;^{[&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,</span><span class="se">\\</span><span class="s1"> &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;]}$&#39;</span>
	<span class="k">return</span> <span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="s1">&#39;mathrm&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">texnumber</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">prec</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
	<span class="n">texn</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;{:.&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">prec</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;g}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
	<span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(-?[0-9]+(\.[0-9]+)?)e(.[0-9]+)&#39;</span><span class="p">,</span> <span class="n">texn</span><span class="p">)</span>
	<span class="k">if</span> <span class="n">match</span><span class="p">:</span>
		<span class="n">texn</span> <span class="o">=</span> <span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">times 10^{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span> <span class="o">+</span> <span class="s1">&#39;}$&#39;</span>
	<span class="k">return</span> <span class="n">texn</span>


<div class="viewcode-block" id="compare"><a class="viewcode-back" href="../../comparepulls.html#SMEFT19.comparepulls.compare">[docs]</a><span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="n">wfun</span><span class="p">,</span> <span class="n">fin</span><span class="p">,</span> <span class="n">fout</span><span class="p">):</span>
	<span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Lists the comparison between the pull of each observable in the NP hypothesis and the SM.</span>

<span class="sd">:Arguments:</span>
<span class="sd">	- wfun\: Function that takes a point in parameter space and returns a dictionary of Wilson coefficents.</span>
<span class="sd">	- fin\: Path to the file `.yaml` where the ellipsoid is saved.</span>
<span class="sd">	- fout\: Path to the `.tex` file where the comaparison table will be written. The observables are ordered by their SM pull, and are shaded in green if the NP improves this pull and in red otherwise.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">dbf</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
	<span class="n">bf</span> <span class="o">=</span> <span class="n">dbf</span><span class="p">[</span><span class="s1">&#39;bf&#39;</span><span class="p">]</span>

	<span class="n">w</span> <span class="o">=</span> <span class="n">wfun</span><span class="p">(</span><span class="n">bf</span><span class="p">)</span>
	<span class="n">gl</span> <span class="o">=</span> <span class="n">SMEFTglob</span><span class="o">.</span><span class="n">gl</span>
	<span class="n">glNP</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">parameter_point</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
	<span class="n">glSM</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">parameter_point</span><span class="p">({},</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
	<span class="n">obsSM</span> <span class="o">=</span> <span class="n">glSM</span><span class="o">.</span><span class="n">obstable</span><span class="p">()</span>
	<span class="n">obsNP</span> <span class="o">=</span> <span class="n">glNP</span><span class="o">.</span><span class="n">obstable</span><span class="p">()</span>
	<span class="n">obscoll</span> <span class="o">=</span> <span class="n">loadobslist</span><span class="p">()</span>

	<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fout</span><span class="o">+</span><span class="s1">&#39;.tex&#39;</span><span class="p">,</span> <span class="s1">&#39;wt&#39;</span><span class="p">)</span>
	<span class="n">obsnum</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">begin</span><span class="si">{longtable}</span><span class="s1">{|c|c|c|c|c|}</span><span class="se">\\</span><span class="s1">hline</span><span class="se">\n</span><span class="s1"> &amp; Observable &amp;</span><span class="se">\t</span><span class="s1"> NP prediction &amp;</span><span class="se">\t</span><span class="s1"> NP pull &amp; SM pull</span><span class="se">\\</span><span class="s1">endhead</span><span class="se">\\</span><span class="s1">hline</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">obscoll</span><span class="p">:</span>
		<span class="n">NPpull</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">obsNP</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;pull exp.&#39;</span><span class="p">])</span>
		<span class="n">SMpull</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">obsSM</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;pull exp.&#39;</span><span class="p">])</span>
		<span class="k">if</span> <span class="n">NPpull</span> <span class="o">&gt;</span> <span class="n">SMpull</span><span class="p">:</span>
			<span class="n">col</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="o">*</span><span class="p">(</span><span class="n">NPpull</span><span class="o">-</span><span class="n">SMpull</span><span class="p">)))</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> $ </span><span class="se">\\</span><span class="s1">sigma$ &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> $ </span><span class="se">\\</span><span class="s1">sigma$ </span><span class="se">\\\\</span><span class="s1"> </span><span class="se">\\</span><span class="s1">hline</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obsnum</span><span class="p">,</span> <span class="n">tex</span><span class="p">(</span><span class="n">obs</span><span class="p">),</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">obsNP</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;theory&#39;</span><span class="p">],</span> <span class="mi">5</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\cellcolor{red!&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;} &#39;</span> <span class="o">+</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">NPpull</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">SMpull</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
		<span class="k">elif</span> <span class="n">SMpull</span> <span class="o">&gt;</span> <span class="n">NPpull</span><span class="p">:</span>
			<span class="n">col</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="o">*</span><span class="p">(</span><span class="n">SMpull</span><span class="o">-</span><span class="n">NPpull</span><span class="p">)))</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> $ </span><span class="se">\\</span><span class="s1">sigma$ &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> $ </span><span class="se">\\</span><span class="s1">sigma$ </span><span class="se">\\\\</span><span class="s1"> </span><span class="se">\\</span><span class="s1">hline</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obsnum</span><span class="p">,</span> <span class="n">tex</span><span class="p">(</span><span class="n">obs</span><span class="p">),</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">obsNP</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;theory&#39;</span><span class="p">],</span> <span class="mi">5</span><span class="p">),</span> <span class="sa">r</span><span class="s1">&#39;\cellcolor{green!&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">col</span><span class="p">)</span> <span class="o">+</span><span class="s1">&#39;} &#39;</span> <span class="o">+</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">NPpull</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">SMpull</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> $ </span><span class="se">\\</span><span class="s1">sigma$ &amp;</span><span class="se">\t</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> $ </span><span class="se">\\</span><span class="s1">sigma$ </span><span class="se">\\\\</span><span class="s1"> </span><span class="se">\\</span><span class="s1">hline</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obsnum</span><span class="p">,</span> <span class="n">tex</span><span class="p">(</span><span class="n">obs</span><span class="p">),</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">obsNP</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;theory&#39;</span><span class="p">],</span> <span class="mi">5</span><span class="p">),</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">NPpull</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">texnumber</span><span class="p">(</span><span class="n">SMpull</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="p">)</span>
		<span class="n">obsnum</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">end</span><span class="si">{longtable}</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<div class="viewcode-block" id="pointpull"><a class="viewcode-back" href="../../comparepulls.html#SMEFT19.comparepulls.pointpull">[docs]</a><span class="k">def</span> <span class="nf">pointpull</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="n">printlevel</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">numres</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
	<span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Determines the observable whose pull changes the most between two NP hypothesis.</span>

<span class="sd">:Arguments:</span>
<span class="sd">	- x\: Point in space parameter of the tested NP hypothesis.</span>
<span class="sd">	- wfun\: Function that takes a point in parameter space and returns a dictionary of Wilson coefficents.</span>
<span class="sd">	- bf\: Point in space parameter of the reference NP hypothesis (e.g. the best fit).</span>
<span class="sd">	- [printlevel\: 0 for silent mode, 1 for verbose mode.]</span>
<span class="sd">	- [numres\: Number of observables displayed. Default=5.]</span>

<span class="sd">:Returns:</span>
<span class="sd">	- A multi-line string. Each line contains the id number of the observable, its name and the squared difference of the pulls.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">w</span> <span class="o">=</span> <span class="n">wfun</span><span class="p">(</span><span class="n">bf</span><span class="p">)</span>
	<span class="n">wx</span> <span class="o">=</span> <span class="n">wfun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
	<span class="n">gl</span> <span class="o">=</span> <span class="n">SMEFTglob</span><span class="o">.</span><span class="n">gl</span>
	<span class="n">glNP</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">parameter_point</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
	<span class="n">glx</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">parameter_point</span><span class="p">(</span><span class="n">wx</span><span class="p">)</span>
	<span class="n">obsSM</span> <span class="o">=</span> <span class="n">gl</span><span class="o">.</span><span class="n">obstable_sm</span>
	<span class="n">obsNP</span> <span class="o">=</span> <span class="n">glNP</span><span class="o">.</span><span class="n">obstable</span><span class="p">()</span>
	<span class="n">obsx</span> <span class="o">=</span> <span class="n">glx</span><span class="o">.</span><span class="n">obstable</span><span class="p">()</span>
	<span class="n">obscoll</span> <span class="o">=</span> <span class="n">loadobslist</span><span class="p">()</span>
	<span class="n">dicpull</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
	<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
	<span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">obscoll</span><span class="p">:</span>
		<span class="n">pull</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">obsNP</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;pull exp.&#39;</span><span class="p">])</span><span class="o">*</span><span class="n">sign</span><span class="p">(</span><span class="n">obsNP</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;theory&#39;</span><span class="p">],</span> <span class="n">obsNP</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;experiment&#39;</span><span class="p">]</span> <span class="p">)</span>
		<span class="n">pullx</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">obsx</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;pull exp.&#39;</span><span class="p">])</span><span class="o">*</span><span class="n">sign</span><span class="p">(</span><span class="n">obsx</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;theory&#39;</span><span class="p">],</span> <span class="n">obsx</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="n">obs</span><span class="p">],</span> <span class="s1">&#39;experiment&#39;</span><span class="p">]</span> <span class="p">)</span>
		<span class="n">dicpull</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">pullx</span><span class="o">-</span><span class="n">pull</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
		<span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
	<span class="n">sortdict</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dicpull</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">dicpull</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="n">numres</span><span class="p">]</span>
	<span class="n">results</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
	<span class="k">for</span> <span class="n">obs</span> <span class="ow">in</span> <span class="n">sortdict</span><span class="p">:</span>
		<span class="n">results</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">obscoll</span><span class="p">[</span><span class="n">obs</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dicpull</span><span class="p">[</span><span class="n">obs</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
	<span class="k">if</span> <span class="n">printlevel</span><span class="p">:</span>
		<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
	<span class="k">return</span> <span class="n">results</span></div>

<div class="viewcode-block" id="notablepulls"><a class="viewcode-back" href="../../comparepulls.html#SMEFT19.comparepulls.notablepulls">[docs]</a><span class="k">def</span> <span class="nf">notablepulls</span><span class="p">(</span><span class="n">wfun</span><span class="p">,</span> <span class="n">fin</span><span class="p">,</span> <span class="n">fout</span><span class="p">):</span>
	<span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Determines the observables whose pull changes the most between the best fit and the notable points of the ellipsoid.</span>

<span class="sd">:Arguments:</span>
<span class="sd">	- wfun\: Function that takes a point in parameter space and returns a dictionary of Wilson coefficents.</span>
<span class="sd"> 	- fin\: Path to the file `.yaml` where the ellipsoid is saved.</span>
<span class="sd">	- fout\: Path to the `.tex` file where the comaparison table will be written.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fout</span><span class="p">,</span> <span class="s1">&#39;wt&#39;</span><span class="p">)</span>
	<span class="n">dbf</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
	<span class="n">bf</span> <span class="o">=</span> <span class="n">dbf</span><span class="p">[</span><span class="s1">&#39;bf&#39;</span><span class="p">]</span>
	<span class="n">v</span> <span class="o">=</span> <span class="n">dbf</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span>
	<span class="n">d</span> <span class="o">=</span> <span class="n">dbf</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
	<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bf</span><span class="p">)</span>
	<span class="n">p</span> <span class="o">=</span> <span class="n">delta_chi2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
	<span class="n">H</span> <span class="o">=</span> <span class="n">v</span> <span class="o">@</span> <span class="n">d</span> <span class="o">@</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
		<span class="c1"># Moving along operator axes</span>
		<span class="n">dC</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]))</span>
		<span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
		<span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dC</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Operator &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;+</span><span class="se">\n</span><span class="s1">**********************</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pointpull</span><span class="p">(</span><span class="n">bf</span> <span class="o">+</span> <span class="n">delta</span><span class="p">,</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Operator &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-</span><span class="se">\n</span><span class="s1">**********************</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pointpull</span><span class="p">(</span><span class="n">bf</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
		<span class="c1">#Moving along ellipsoid axes</span>
		<span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
		<span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Axis &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;+</span><span class="se">\n</span><span class="s1">**********************</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pointpull</span><span class="p">(</span><span class="n">parametrize</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;Axis &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-</span><span class="se">\n</span><span class="s1">**********************</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pointpull</span><span class="p">(</span><span class="n">parametrize</span><span class="p">(</span><span class="o">-</span><span class="n">delta</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span><span class="p">),</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
		<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="n">bfm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">bf</span><span class="p">)</span>
	<span class="n">dSM</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="p">(</span><span class="n">bfm</span> <span class="o">@</span> <span class="n">H</span> <span class="o">@</span> <span class="n">bfm</span><span class="o">.</span><span class="n">T</span> <span class="p">)</span> <span class="p">))</span>
	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SM+</span><span class="se">\n</span><span class="s1">**********************</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pointpull</span><span class="p">(</span><span class="n">bf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dSM</span><span class="p">),</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SM-</span><span class="se">\n</span><span class="s1">**********************</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
	<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pointpull</span><span class="p">(</span><span class="n">bf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">dSM</span><span class="p">),</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
	<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="pullevolution"><a class="viewcode-back" href="../../comparepulls.html#SMEFT19.comparepulls.pullevolution">[docs]</a><span class="k">def</span> <span class="nf">pullevolution</span><span class="p">(</span><span class="n">obscode</span><span class="p">,</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">fin</span><span class="p">,</span> <span class="n">direction</span><span class="p">):</span>
	<span class="sa">r</span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Calculates the variation of the pull along a line connecting two opposite notable points of the ellipsoid.</span>

<span class="sd">:Arguments:</span>
<span class="sd">	- obscode\: ID-Number of the observable, as returned by comparepulls.pointpull</span>
<span class="sd">	- wfun\: Function that takes a point in parameter space and returns a dictionary of Wilson coefficents.</span>
<span class="sd"> 	- fin\: Path to the file .yaml where the ellipsoid is saved.</span>
<span class="sd">	- direction\: string with the following format\:</span>

<span class="sd">		- &#39;wc&#39; + str(i)\: for the i-th Wilson coefficient.</span>
<span class="sd">		- &#39;ax&#39; + str(i)\: for the i-th principal axis of the ellipsoid.</span>
<span class="sd">		- &#39;sm&#39;\: for the direction joining the bf and sm points.</span>
<span class="sd">	&#39;&#39;&#39;</span>
	<span class="n">dbf</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
	<span class="n">bf</span> <span class="o">=</span> <span class="n">dbf</span><span class="p">[</span><span class="s1">&#39;bf&#39;</span><span class="p">]</span>
	<span class="n">v</span> <span class="o">=</span> <span class="n">dbf</span><span class="p">[</span><span class="s1">&#39;v&#39;</span><span class="p">]</span>
	<span class="n">d</span> <span class="o">=</span> <span class="n">dbf</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">]</span>
	<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bf</span><span class="p">)</span>
	<span class="n">p</span> <span class="o">=</span> <span class="n">delta_chi2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
	<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
	<span class="n">H</span> <span class="o">=</span> <span class="n">v</span> <span class="o">@</span> <span class="n">d</span> <span class="o">@</span> <span class="n">v</span><span class="o">.</span><span class="n">T</span>
	<span class="n">pull_list</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">obscoll</span> <span class="o">=</span> <span class="n">loadobslist</span><span class="p">()</span>
	<span class="n">obs</span> <span class="o">=</span> <span class="n">obscoll</span><span class="p">[</span><span class="n">obscode</span><span class="p">]</span>
	<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">direction</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;wc&#39;</span><span class="p">:</span>
			<span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">direction</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span><span class="o">-</span><span class="mi">1</span>
			<span class="n">dC</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="n">H</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]))</span>
			<span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dC</span>
			<span class="n">point</span> <span class="o">=</span> <span class="n">bf</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">delta</span>
		<span class="k">if</span> <span class="n">direction</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ax&#39;</span><span class="p">:</span>
			<span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">direction</span><span class="p">[</span><span class="mi">2</span><span class="p">:])</span><span class="o">-</span><span class="mi">1</span>
			<span class="n">delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
			<span class="n">delta</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c</span>
			<span class="n">point</span> <span class="o">=</span> <span class="n">parametrize</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="n">bf</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">direction</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;sm&#39;</span><span class="p">:</span>
			<span class="n">bfm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">bf</span><span class="p">)</span>
			<span class="n">dSM</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">p</span><span class="o">/</span><span class="p">(</span><span class="n">bfm</span> <span class="o">@</span> <span class="n">H</span> <span class="o">@</span> <span class="n">bfm</span><span class="o">.</span><span class="n">T</span> <span class="p">)</span> <span class="p">))</span>
			<span class="n">point</span> <span class="o">=</span> <span class="n">bf</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">c</span><span class="o">*</span><span class="n">dSM</span><span class="p">)</span>
		<span class="n">pull_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SMEFTglob</span><span class="o">.</span><span class="n">pull_obs</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">wfun</span><span class="p">)</span> <span class="p">)</span>
	<span class="k">return</span> <span class="n">pull_list</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">SMEFT19</a></h1>








<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../SMEFTglob.html">SMEFTglob</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ellipse.html">ellipse</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../obsuncert.html">obsuncert</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../comparepulls.html">comparepulls</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plots.html">plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../scenarios.html">scenarios</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ml.html">ml</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2019, Jorge Alda.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.8</a>
      
    </div>

    

    
  </body>
</html>